let rawEx = "???.### 1,1,3@.??..??...?##. 1,1,3@?#?#?#?#?#?#?#? 1,3,1,6@????.#...#... 4,1,1@????.######..#####. 1,6,5@?###???????? 3,2,1"

let rawFull = "??????.??#. 2,3@??.?###????????? 2,4,4@?????????.??##? 1,2,1,1,5@?##?.????.?#?.?#? 3,1,1,2,2@?#?.#?##???? 3,1,4@??#????#?? 4,4@???????#?.??? 2,2@?.???????#? 2,3@.?????.???? 1,1@#??????????# 1,3,3,1@??.??.??..#? 2,1,1,1@.??#?#?#?? 1,4@#???????.?? 6,1@???#???#??# 1,2,5@.#?.??#.?#? 1,2,1@?#?#??????.#.? 9,1@#?????.???? 5,2@?????????????? 1,1,3,5@.???.??##?.???.#?? 2,3,3,1@?#??#???#??????? 2,6,1,3@??.??#???.?# 1,1,4,1@?#????###.???#?? 8,6@?????????..? 2,1,1,1@??.??####..? 2,6,1@.????##???????? 2,4,1,1@?????.?##???..??? 1,3@??.???.?????#??.? 1,4@#?#?###?..?.#??..#?. 8,1,1,2@??#??????#??#???? 9,5@???##???##?.??#???. 2,3,2,1,1,2@?#?#???.?? 6,1@?????#?????#? 1,8@??????.???##?#??#.? 2,1,1,8@?????#.???? 1,1,3@??????.??. 1,1,1@.?.##????#?#??#?.? 9,2@???#??????#??. 1,11@??#?.#?.?? 3,2,1@#????.???#.???? 1,2,3,2@.??.???.??#? 2,3,3@??.????????#?.??? 1,8,2@.?#??#?.???.. 6,1@?????.????#.? 1,1,4@.??#??.??????? 4,4,1@?.#???????.?????? 3,1,1,2,1@##.?????#??#???#?# 2,1,1,1,5,1@...??????.#???#??#? 1,1,1,1,7@???##???????#??? 7,2,1,1@##.????????????.. 2,9,1@??##?.????#? 4,1,3@?#??????#. 1,1,1@?#...?.?##?#?????? 1,1,4,1,1,1@?#????#???#??.?##? 3,7,4@.#???##??###???? 2,10@.?#?.?#??????. 1,7@#.?.?????###.? 1,1,7,1@???..#.??? 1,1,1@???###????????#?#. 12,4@????..??.?.???. 2,1,1,1,2@???.#??????#? 1,8@??#.???.?..??##?.. 1,5@??#????.????.??. 5,1,1,1@##???..#.???#???. 2,2,1,5@??##?.?##.???#.???.? 4,3,1,1,2,1@?????????????.# 2,1,1,1,1@.???#?#??#?.???# 1,6,1,1@?#?#???.??#?? 3,1,4@???#???#??#??#??# 1,3,1,5,1@.????.#??# 3,4@?????.????### 4,6@????#??.#????.??? 2,2,3,1,1@???#?...?#???. 4,5@?????..?#?.? 1,1,2,1@???.??###??##? 1,9@?.?#?#????.??#?.??# 1,7,2,1@?##???..???##.?#.. 4,5,1@????#.??#. 1,1@?.??#?.??#? 1,4@???#????????#??.? 1,2,2,5,1@?##?????#??#???.???? 4,3,4,1,2@???#???.??.?## 5,2@?????#???#?#.????#? 2,8,2,1@..??#?..??? 2,1,1@.??##??#????###?? 9,4@???.??????????? 1,3,1,3@.#?##??#?##????#?? 10,1,3@.???#.?##?? 1,1,3@?#??#?.??? 2,1,2@.?#?.?????? 2,3,1@?.#.???#.? 1,1,1@??#?????#?#?. 5,4@??.?#?#.???? 1,3,2,1@???????#?#??????? 3,6,5@?????????.#???? 7,4@.?###??.?????#?? 6,5@??#?????#####?.# 3,9,1@.#???.???.?? 3,1,2@??#?????????#? 9,2@?????????#?? 1,2,1,2@.?????#???.??? 8,1@?#?.?#?????#???#. 1,1,8@???#??#?###?#??#? 1,14@????#?.??# 1,2,1@?#####.?#?????. 6,1,2@#?????.??#? 5,1,2@?#?????.#?#? 6,1,1@?.????#?????####?.. 1,3,7@?????#???#????##? 1,3,8@..????????..?? 4,1,2@??.#?#???.. 2,3,1@##?#?.???#?.. 5,1,1@?#?#??..#?#.? 2,3,3,1@?#?#????...??????? 1,1,2,3,1,1@..?#???..??? 5,1@??#?.???.???? 2,3,3@..??#?????##??? 6,5@##???..##???##?? 5,2,3@#???#???#####????#. 1,1,9,2@#.??????#.?##?##??? 1,2,1,2,6,1@???.#????? 1,1,1@????.???..???. 2,1,1,2@.?#??.??.#.#. 3,1,1,1@??????.?##?? 1,1,1,3@?#??#??#?.??#?. 1,1,2,1,2@??????##?? 1,1,5@.???#????? 1,1,1@?#?.??????. 1,1,2@?.?.?#??????.??#. 1,2,1,3@.??#??????.??.#.? 8,1,1@???#?.???###? 2,1,3@?##?.?.???.???????#? 3,2,1,5@?..????#???##?? 1,2,1,4,1@???##???..???.?? 5,2@..##????##?##?.?.??. 11,1@??.??..?#???? 2,1,1,1@??.#???#?#???? 1,1,6,1@?#??.??#???# 1,1,3,1@???.??.?????? 1,2,1,1@???.#??.?? 2,2,1@???.?#?.???????? 1,3,5@?????#???#??##. 1,6,1,3@.#??.?.?.? 2,1,1@#?##??#?????? 7,3@??.?.???#??????? 1,1,6,1@?????#.?#???..??? 5,3,1@#??#???????.????#.# 4,1,2,1,3,1@.???????.?? 4,1@...??#?#?#?????# 5,4@#...??#?????#?#?.? 1,3,7@????.#?.#.??##??? 1,1,1,4,1@???..?#?????#??? 1,1,2,2,1@?????..??##? 1,4@.#??????#??#?? 1,1,1,6@?..?#?????#???. 3,3@??.##?#???????#. 1,7,2,1@?????##..#?.?. 5,1,1@..??????##??? 4,2@?????.?????. 2,1,1,1@..???##?#???.??#.?#? 1,6,2,3@????????#??????. 1,1,7@#??#???#?#.???#?#?? 10,6@.#?????#??.?# 1,2,2,1@.?..??.????# 1,1,4@????#?#??.. 2,6@.?#..????. 2,1@?????#?#?#???????.?? 2,8,4,1@#?????#???? 1,5,2@???.???#?###?#?##??? 2,13,1@?#????.???##.# 2,1,4,1@??????????.??. 3,4,1@???????.#???.?#??? 1,3,1,1,2,1@.??.#?###?. 1,6@.#.?#????#? 1,1,3@?????????##.?# 2,4,2,2@????.?..??. 1,2@???????#?? 1,1,1@???????#??. 5,1@??#.??#?????## 1,1,1,5@???.?.?#?.? 1,2,1@.???##???? 2,6@#?.?#?.????#???#? 1,2,1,2,4@???.?####?#? 2,6@???.##.?.#?# 2,3@?.???#?#??# 1,5,1@?.??#?##?.##?#?#?. 6,7@..?#??..?. 3,1@???#?#??#.??#..???# 1,1,4,2,1,1@#????.?????? 1,1,3@?#?#?.??##?#??? 5,1,2,2@..?#?#?#????#?? 7,4@???.??#??????..????? 3,1@????#???.????#?????? 1,3,8,1@.????#????#??##???## 6,1,8@??.#????????.? 1,1,2,2@???#????#?##?????? 1,1,1,4,1,1@#.??.????#??###...? 1,1,1,6,1@???#??##??#?? 1,5,2@#.#???#??????.?? 1,3,2,1,1@??#..?.#?? 2,1,1@..??????#. 1,2@#??????#??.???.???#? 4,1,3,1,1,2@?.#??????##?#??#?? 3,8@?#???.????.????? 1,2,2,2,1@???????#???.?? 5,1,1,1@..?????#?#??#? 1,3,2@#??.####?.?? 1,1,4,2@???????#??###??#?. 1,1,13@.?#.??#?..??#??#? 1,2,1,5@#?#?#??.??.. 1,5,1@.????????.?.??. 2,1,1,1,1@##???????.? 4,1,1@#?#?.??##??????.#?. 4,5,1,1,1@#?#????#??.???? 1,1,1,3,3@???.?????.##??## 2,6@...???#?????? 1,1@##?#??????????.??. 8,3@..??#?????#??????#? 4,5,3@????????#??? 1,2,4@?.#??.??##?.?. 3,3@???.??#.?# 3,3,1@?#????.?.? 1,1@?#???????#????? 4,3,3,1@.?.??#????.?.. 7,1@????#.?.#..? 3,1,1,1@.??#?#?????.?????#?. 5,2,1,1,1,1@??????.?????#?.??# 4,4,1@???###.?#?#????? 1,4,1,6@???????.???#??? 6,3@??#?###?????????? 6,1,1,3@.??#.???##??#????#?. 1,4,2,4@#.??##?#??????#????? 1,10,2,1,1@.??.#??#????#? 1,1,5,1@.?#????..????? 4,1,4@????..?#??... 1,3@?.????#??? 1,1,5@??#?.#??.??????? 4,3,2,2@?#????#???????##?? 3,1,2,1,2,2@##?.?#.??? 2,2,1@?.????????.?##???.?. 7,4@..#???.?????#? 2,7@#?.???..#??? 2,3,1,2@????????##. 1,3@?????#??#?. 1,5@???????#?#????.??? 10,2@????????#????????. 7,1@???...#??# 2,1,1@??.#???#?#?###?.#? 2,2,8,2@#???#?????? 1,3,2@.?.?..???#???? 1,4@????.##???#?###?? 1,1,4,1,5@??#???#??# 2,2,1@??#?##??????? 7,1@??#?#.##?#? 1,3,4@??#???#?..?????.?? 6,2@?.?????.?#?#??#? 1,1,7@#??.???#???##??#. 1,9@?.?.?..?.??? 1,1,1,3@.?????????#.???? 1,1,1,1,3@?#???????? 5,1,1@.#?##??#?. 4,1@.?#????#??. 3,3@.?#.??#??###?? 1,8,1@???#??.???.? 4,1@?.#????##???? 1,2,4,1@.???##.????#??##.??? 5,2,1,3,2@???##?##???? 8,1@?###????#????.?? 5,2,1@#?.???????? 1,4@???#.?#??. 3,1@????.#?#?##?????? 2,1,8@.##?.?##?????# 2,3,2@.?#..????##??????##. 1,2,4,4@?.?#???###? 1,2,4@??????#??????#???? 7,5@??##?#..??? 6,1@??????.???#. 4,1,1@.??.?.????? 2,1,1@?????#.?##?#?##??? 1,1,10@#?##?#??.? 1,5,1@?.?#?#???..???? 1,5,1,1@?..????##???????..?. 1,2,9,1@?#?#..?.???#?#? 1,1,1,4@?#.??????# 1,5@.??????#???#?##???. 4,9@.?.???????## 1,2,1,2@????.#?.????# 1,2,5@?????.?????. 1,1,3@..??..???? 2,1@??#.??#??##??#? 1,1,7,2@??????#??#?.??.#.? 6,1@????.????#?#???.#??? 1,1,1,6,4@?.??.#??????????? 1,1,2,4,1@???..????? 1,1,1@.?#?????.?#.??#?.. 3,1,1,3@?#??????#?#??##??# 6,3,3,1@#?#???.??.?????.? 5,1,5@???????##?.????#???? 6,5@??##???#???? 4,5@?.##????#???.???#?? 3,5,4@??#?#?.??.??## 5,2@??.?????.#? 2,2@?#??##??#?????#???.? 6,2,1,5,1@????#?#.?? 1,3,1@??.#??.??#??????.?? 2,3,6@?.???#.?????#??# 1,1,1,1,4@?#??????#?? 2,1,4@??????.???#?? 2,2,3,1@??.??#..##? 1,1,2@???.?????. 3,2@?..#???#???????#???? 8,4@??#??????##? 3,1,4@.?#??#????????.?? 1,7,1@??#??#?..?#??###? 1,3,8@..#????###? 1,4@?#.???#???..?.?# 2,6,1,2@?.??#?##?.???#??? 1,1,2,1,3@?.?????#??#???.??? 4,1,4@?.???##???#????? 1,8@?#??#?????????##?##? 7,2,5@.??..?????#?###??#? 2,1,1,8@#???##?.?.???##??##? 2,3,5,2@???#..?#??#?? 1,1,5@??????.????. 4,2@?#??.?????.?? 1,3,1,1@#?#?.?#?.???# 4,1,4@?????......?.???.?.. 1,1@??.?????#??##?? 1,4,2,4@..?#???..??.??# 4,3@.?.??#????.??. 1,3,1@?#??.#?????.?. 2,5@.?..?#?#???##?? 1,10@?.???????###?#?. 2,6@??#????.?.????#.. 3,1,1,2,1@?#??????.?#?#.? 3,1,4@?#?##??#??.?##. 6,3,2@#?###???.???...??#?# 5,1,1,1,1,3@.?#????????????. 2,3,1,1,1@.?#??#??#??.#???? 1,2,3,1,1@??#??.????.#? 3,4,2@##...?#??..??###???? 2,2,8@##??#?#?.?#.????? 8,1,4@##???.???? 2,1,1@#??##?.????#????.??. 1,4,1,3,2,1@?.?.?#?##?###?? 1,9@?????##.?#?? 1,5,1,1@???..#?#???#???. 1,1,4,1,1@??##?.????????? 4,3,2@#?#????.???.???#. 1,1,1,1,4@???..????#? 1,3,1@?##????##???.??? 6,2,1,1@#???.#..#?#?? 1,1,1,3@.??????.?????# 6,3,1@.??.?##??????#?.#?#? 1,5,1,1,4@#?.?.?????.?#? 1,5,1@????????#???#?. 1,1,1,3,1@.??????#?#?.?#?##?? 1,5,7@.????#??#??#.??.? 11,1@?#??..#.?????### 3,1,3,3@???.?#.??.?#. 2,1,1,1@#.??????????#?.#### 1,10,4@?????.???# 1,2@???..???????## 1,1,3,2@???????#.? 2,1,1@#????##?????? 1,1,5,1@.???.??#???..?? 1,1,4,1,1@?..?...???#??? 1,2,1@#???.?#??#????? 1,1,1,7@?.#??.##????? 1,6@.?????#.?.? 2,1@?#???????#?#??.?.? 3,9@##????????#?##.#.# 6,1,4,1,1@???.?#?##.??#. 5,3@?..?..#?##.? 1,4,1@.?#??#??.?##????#?. 6,2,1,2@?#??#.?#.?.????? 3,1,1,1,1@???????.?#??????# 3,2,6,1@?#?..??.##?#?.?? 2,5,1@?#...#??#? 1,1,1@?.#????##???#?. 3,7@??..#??##? 1,2,3@??????.?##?? 2,3@????.#???????#?#?. 2,1,1,6@???????#??? 1,1@?...????.???# 3,4@.#??##??.????. 1,2@?????.?#???? 1,2,6@?#???#?.#? 2,2,2@??#??????? 5,1@?.????##??.?.???... 3,1@..##??#??.? 5,1@???.??#?##???? 2,1,4,2@???????#????????..? 8,1,1,1@??#.???.???#???? 2,1,1,2,1@?#?##.??#??????#? 4,3,2,1,2@??????#.???? 1,3,3@?##.?#.??#?.??????#? 3,2,4,2,3@.#?#???#??# 3,1,1@.??.???????## 1,1,4@#??#??.#???# 1,4,2,1@???#?#??.. 1,1,1@????#.?????.. 4,1,1@??????.???.?? 1,2,1,1@#.##??#?.?#..??#?.? 1,6,2,2,1@???.??..?#?.. 3,1,3@????#????#?#####??#? 2,1,9,3@??#?#??.#?##??##.. 4,8@??????#?#???#?.?.? 12,1@?..?????##???#? 1,12@.#????#??#.? 1,6,1@???#?#??#?#??????? 1,1,1,1,4,3@?.??#.??.??? 1,1,2@???#???#.??#?? 5,1@.????#.?#?? 1,3,4@?#.#?#?????##.?# 1,5,3,2@???????#?????????. 2,1,5,1,2@#?#?#?#??#.#???.???? 8,1,1,1,1,1@?????#??#??.?# 2,8,1@?#??#???#??.?#.?? 9,2,1@?????##?#?.?. 1,6,1@???????.?...?#? 1,4,1,2@?.#????.????????.?.? 3,1@#????????#????#???.? 1,10,1,2@???.#???.#?#?????# 3,1,1,9@.?????.?????? 1,1,2,1@#?.??##??????#? 2,3,4@?????.??????.? 2,1@?#?#?#??#?. 1,7@.????.???#?.???# 3,5,2,1@??#????##?. 3,4@?.???????????#??#??. 2,5,2,1@?????#??#???..???? 1,3,1,1,2@.????#?????.. 1,3,3@?##???????? 4,3@??#??#?????#? 2,2,1,1@?#?????#?#?#..#??.?# 2,3,5,1,1,1@?????#???.?#???##??. 6,1,9@???????#??#??#. 1,1,9@##????????.??..#?# 4,1,3,1,1,1@???#.??.???. 1,1,1,1@?.?#????.#??? 1,6,1,1@?????#??????.? 1,3,3@?#????.???# 3,1,4@#??#?#?#??.?#? 8,1,1@?????????#??? 2,5@??#?.??????.###?#?. 4,1,5@#?.?#.??#????? 1,1,1,4@#.???.??#???? 1,1,4,1@?#??????#??? 2,4@?#?????????#??#.???? 5,1,3,1,1,1@??????##??????#?#??? 1,8,7@#?#??.????.#?#? 3,1,1,1,1@?.??#.#?##. 1,1,4@???.??#??#.???? 1,1,6,1,1@#?????#??# 1,4,2@?.?????.?#????? 1,1,1,4,1@.?....??.#?. 1,2@.#???#????#.???##??. 10,5@???????.#? 5,2@?.##??..????# 4,1,1@??#?????#???.??? 6,4,1,1@??.?.?##?.???.?? 1,1,4,3@?????.???.????#? 1,2,2,1,4@?..??##?#..???.? 1,5,1,1@???.???#??.#?.????? 3,4,2,1@???#???#?? 1,4@###??..???..?. 5,2@#????????#? 1,3,4@??.???????.?#?.?# 1,1,2,2,2@??.??.?..?????. 1,2,1,2,1@????#???.?? 1,5,2@#?.?..?#??##?.???# 2,1,7,1,2@.#??..#.??#????## 1,1,9@??????.???#????? 2,1,7@?###???.??? 3,2@?.#?.?##?? 1,1,2@???###???.??#?.??? 6,2,3@?????#??.????????? 4,1,1,2,1,1@?#.?##??##?#. 1,7,1@??.???????#???##? 1,1,1,8@.???????.????????? 5,7@..#?????????#???#.?? 1,2,8@#??##????#????#. 2,4,2,3@.??#???#??? 2,3@?#???#???## 1,1,3@???#?#??.?#? 5,1@??##??.?.????#? 5,1,1,2@?##?#??#??????## 8,1,3@?##??#???????? 5,1,1,1@??###?????#???.??#. 1,9,1,1,1@?#.??????# 2,2,3@?#??#???#?.?.?????? 10,1,1,1,1@??#???#??. 1,3@?#??#.???? 2,1,1@???.???#??????.? 2,6,1@#?#?.??.#.??##? 1,2,1,1,5@???????????.?#?. 1,3,1@.?#?#?..#. 4,1@??#?#????. 3,1,1@?#??????#?????? 10,2@#.????????#?#??? 1,2,1,5@?????????#.#? 1,2,1,2@??#?#?##???.?.? 9,1@??????.???.. 5,2@.?????#??? 3,3@??.????????? 1,1,2,1@.#???????##. 1,1,3@?##?#???#?..??#??#?# 3,1,2,6,1@.?..##???? 3,1@??????#.?????? 1,2,1,5@???#.????#?? 1,1,1,4@???#????.? 2,2,1@.#??.???#??????.? 2,7@?.?.###?#?.?. 1,6@?.?##.?.?? 1,2,1@?#...?.?#??#?.???.? 1,4@?????????.??? 4,4,1@??#???????.#. 7,1@?.???#?????????#??? 1,1,7,3,2@.??#.?????.?.?.? 2,1,2,1,1@.???##????#? 6,1@.##?..??????? 3,6@.#??#?#??#?.??.?. 4,5,1,1@?.???.???? 1,1,1@????????????#??? 3,3,5,1@??.???.??? 1,3,1@???##????. 6,1@?##?.???#? 2,1,2@.?.????.??#??#?#? 1,1,6,1@#??????#.? 5,1@.?#????????.? 2,1,1@?.???..???????? 3,3,2@????????#??# 1,1,4,1@##..??#??.?????? 2,4,1,2@???#???#???#????? 1,7,4,1@..????#???????? 3,3@.#?#????##?.??????? 9,2@???#???#??.?##?? 1,2,2,3@???#?????#?.??????? 1,1,5,1,1,1@????#??.???#. 7,1,1@#?.?.?##??????.??#?? 2,1,6,2,1,1@##??????#.##???#?? 5,1,8@?.?.??#?????#?? 1,1,7,1@??#.????#? 1,3@?#?#?#??#??? 7,3@#???#?#?????? 3,4,1,1@#????#??.??? 1,5,1@#?????#?.. 1,1,3@?.?????#?##?.?##? 10,2@?..??????.?.?????..# 1,6,1,1,1@#?#.??.???????#??? 3,9@.???#..?.?.??##. 4,4@?#?#???#.????#?.???# 1,5,6,1,1@?#.#??#??? 1,2,2@??????#????? 2,7@????.??????..?.?? 2,1,1@??##???##??.??#.?? 3,6,1@.?##??????#?#???#?. 12,3@???.?.#???.?#??? 1,3,5@.??#??##??#???# 7,1,1,1@?.??#.??????????#? 1,1,5,1,3@??#????.??..????.? 3,2@?#??#???..? 4,1,1@??????..???.. 3,1@??????#????#?.??.#? 2,4,2,1,2@.???#??..??###??. 6,6@?#??#?????#?????? 5,7@???##?#?#?#?###??. 1,3,5,3,1@#?????#??.??????# 5,1,1,6@?#??????????????? 5,1,1,4@?.?#?????.? 1,2,4@?.???#????#?#???###? 1,1,2,1,1,8@?#??#?#????.?.??.# 1,5,2,1,1,1@?####?#?????? 6,3@???.?????.??????.# 2,1,1,4,1,1@.??#?#??#?.# 5,2,1@.#?.????.#.##??? 1,3,1,5@?..???##??#?? 3,2@?#??###?##???.?? 2,10@.#?#??.??#. 4,3@#??#.?##???? 1,2,6@????#???.??##?##?# 7,4,2,1@.?.????????.#?? 1,1,1,2@#???.#?.???.##?? 4,1,1,1,4@#???#??.?##?.. 5,4@??????#??#.?.??. 1,1,3,1,1@??.???????? 2,7@???..??#???????? 2,3,2,1@.?#????.????#? 4,1,2@?#?..##???#??? 2,9@.?.???#??#?#????.?? 1,10@.??###?...?#?? 4,4@.#??????##??.? 3,5@?.?#.???????#???#. 1,1,1,7@#???#?????# 2,7@???.?#??#??..?.?? 1,7,1,2@??????.??? 1,2,3@?#??#??.#?#???#???#? 1,3,3,1,5@?..##.?.?#???#?#?#?? 1,2,1,1,1,5@??#???????#??? 11,1@#?###??#?.? 8,1@.#?#??###??????..?? 8,1,1@?#.????.??.??. 2,2,1,1@?#??##?.#?? 6,1,1@??#.??#?#?.?#.?. 3,1,1,1,1@#?#.?#?.??..?#? 3,2,1,1@??????????#??. 1,2,5@???#?????# 3,1,2@???.?????????# 2,2,1,3@?#?##???.???.# 5,1,1,1@??????#?#?????#.. 1,7,2@??.?#?.?????# 1,1,2,1@#??#?.?????#?#??#?? 4,1,2,1,3@???????.?? 2,1,1@?#..#??.??#?.# 1,2,3,1@??#????????? 5,1@???#?###.#???..#??? 3,3,1,1,3@?..???#??????.???. 6,2@.??#?#?##???????? 8,4@??????##?#?#??? 10,1,1@??????#?.. 1,3@...??????...#??.? 2,3@????#?#???? 4,4@?#???..?#?#? 4,3@.?????#???????#???? 6,3@?.????#??????##.?? 4,6@??.?.??.?? 1,1,1@????.???#????#??? 2,1,2,3,4@?.?.??#?#??#?#?#?#? 1,12@??#?#.?????.??# 1,1,3,2@#???..??##????? 1,6,1@?????.?.??#?. 1,1,1,3@...??.???#?###??. 2,6@??.???..?? 1,2@.#?.????..? 2,3@#?#??#?..??#????. 1,5,4,1@??.#.#???#.????#?##? 1,1,1,1,1,6@?#??...??#?. 1,4@.?????????. 3,4@???????#?#???????# 12,1@#??##????#?? 1,3,1,3@?#?##????#.????. 8,1,2@?.???.????# 3,2,1@???#????#???#?? 1,2,5,3@?.?#.?????..? 1,1,1,1@.??.???#?????.???? 2,2,6,1,2@?.???.???#?????.?# 1,1,1,4,1,1@#.##???#?#????. 1,6,2,1@?????#..?????#? 1,1,1,7@?.?.??#.????##?.??? 1,2,1,5,1@?#?#?#???#?#????? 1,3,6,2@??.#?.#?????# 2,1,4,2@?##???.???. 3,1,2@?.#???.?...##???? 1,3,1,2,1@???#????????????? 4,1,2,4@?.?#?????#?#?# 1,1,9@??????...???##??. 2,1,4@???###???#?. 2,4,2@?.??#.??#??#..????? 1,1,1,5,3,1@??.??????#?????? 2,1,3,1@.#?.??#????#?.#. 1,6,1,1@?????##??####?????#? 2,10,1,1@?????#?..??.???#?? 7,2,6@???#.??##?##?.????? 1,1,7,1,3@.?#?#????? 3,1,1@??.?#?#?.?...?? 2,1,2,1,1@?..?#?.??.#?#?? 3,4@#?#.??.??????????. 3,1,6@??#???..??.?. 3,1@??.???.??????.?.?? 1,1,3,1,1,1@?????#?.?.?????#?##? 1,3,1,1,5@?.####.?.??#.? 4,3,1@#????????####??#? 2,2,5,2@?...#??#?##??????? 1,2,4,1,1,2@?##?.?????#???.? 3,1,2,1,1@##..##???#. 2,2,1@..#??????#? 1,1,3@?????????# 1,1,1@?#..????????#??.? 1,3@??##??.?..??#??? 5,5@???#?????.#?#? 1,6,1,1@.??#????##????. 1,6@#??#?????????.??#?.? 7,4,2@.????##?#?? 1,2,1@???#??...??? 5,2@?.??#?#?##?.? 8,1@?????.####???#??.?. 5,4,5@???#????##? 1,7@?#????###???? 2,6@????.?#???##????? 1,9,1@???????.????## 1,1,1,6@???.?#??..???#??#?? 2,1,1,8@.????.???..? 2,2@?.#?#?#???? 1,3,1@?.???#?##??.???.???? 6,2@.##?#?????????#???# 4,13@?##?.?..???# 3,3@?.?##??.??#?..??. 4,4,1@.?#??.??#??#?? 2,7@#??.#?????????#???? 1,15@???.???#?.#?#.? 3,4,3,1@???#??????.?# 7,1,1@?#????####???. 9,1@??????#???? 2,4,1@.?#???????#???#.???# 13,2,1@??##???#??????#?##?. 6,1,1,8@????#??.???? 2,1,3@???????#???#?#? 1,1,4,3@?.##??...?? 4,2@#?##?????????#???# 5,3,6@.???#???#. 5,1@?#??#?#?###????..? 12,1@.#??????????.??????? 3,7,1,3@?????????? 1,6@?#?..????#? 2,5@?..?.#?#?? 1,3@?????.?????#? 1,1,1,5@?##?#?###??#????. 13,1@.??.????.?? 2,1,1@..#?#?#??.#.#?? 6,1,1@??#?#?.##??.? 3,2,1@.????#???.?#? 1,5,1@#.????.???????#?? 1,1,10@????#.??.???#.???? 1,2,1,1,1,2@#.??.???#???#. 1,3,3@???.?.?????????#?.?? 2,1,2,1,3,1@??.??#????# 1,3,1@??##????#?#??##?#??. 10,5@???#???.??.????? 5,1,1,1@????.#????#????#.. 2,11@..??????#??.??#??? 4,3@?#?????.???.??.???? 2,1,1,2,1,2@?.?#????????? 3,1@.???.??#???#???##?? 3,11@??#??#?#??#?.?#???? 2,4,2,3,1@??????##.???.#?? 1,5,1,1@?.#??????#????#?. 1,1,9@?.#??.?#??????.? 3,6@?.#.??????? 1,1,2@?????????##?. 3,6@#?#???...?? 1,3@?###??.????#???????? 5,4,6@???????????#??#??#?? 11,1,1,1@???#??????. 1,3,1@?#??.???#??#? 2,2,5@?###..???##?. 4,3@?##?#?.##???##?.?.# 6,7,1@?##?#??#???. 6,2,1@#??.??.?#????##???#? 1,1,1,9,1@??#????.???#.??. 1,5,3,1@?#?????.???. 2,1,3@?????.?#?#?###???. 4,7@????..?#?#? 1,3@??..?#?????? 2,2,2@???????.???? 5,1@?????.#.?.???##? 3,1,1,3@.????????.#.#. 2,1,1,1@.??#?.?#????#??# 2,8,1@?#?.???#.????? 3,3,4@.??#?##?#???#?.#?? 1,11,1@..???#???...?.?.? 2,1@??.??...#????????? 1,1,1,2,2,2@????..??????.??#. 2,6,3@.??.#?#??#??. 2,1,4@#???#?#.?#?#.?#?? 7,1,1,1,1@?.#????#???#???#? 12,1@..???#???#??????# 6,1,1,1,1@????.?#?.???? 4,3,3@???#???#.??#?#??? 1,5,6@????????.???.???#??# 7,1,2,2,1@??##??.??#.????. 4,2,2@?##?#?##???#.????#?? 11,5,1@..?.?#????? 1,1,2@.??#????????.#???. 9,3@????.#..?#.?#?#?#?? 1,1,1,8@#???#?..???#? 1,2,1,2@??#?.#.##??????# 1,1,1,7,1@?..??#?#?.??#?.? 1,4,3@?????.??.. 1,1@??..#?????.#.?? 1,1,2,1,1@????..?##??????##?# 3,13@?#.????.??.?#????#?# 1,1,1,2,4,3@??#??.???? 4,1@#????#.??? 6,2@#?????.???????? 6,1,5@???#???#.#???.?? 4,2,3,2@#????????? 4,2@#.?.???.???? 1,1,1,1@.#???????.? 3,1@???.??#???###?#?#.#? 1,4,4,1,1,1@?????#???? 6,2@??.#.????#.??#?#??? 2,1,5,1,1,1@??????###?##?? 1,9@.???????????. 3,1,3@.?????#??##?.????. 11,2@??????##??????#???. 2,1,5,1,1@.#??###??.???? 6,1,2,1@.????.??#??????? 4,2,1,1@#????????.#?????#? 2,1,2,4,1@???.##.?#? 2,2,2@?..??????###?????.? 1,9,1@?#??????#???? 2,1,3,2@??##???#??#???? 1,2,6@??.??????????.. 3,3@#?#??.???.?.?? 5,3,1@???.??#?#???????### 1,1,1,1,6@??#??????.??? 5,3,2@??????.???????#? 3,1,3,1,2@.##?#????###?.??# 2,8,1,1@?????????.?#. 1,1,1,1@?..#????#??###?????? 7,9@.???.?#?.#.?.#? 1,3,1,2@.??#.????? 2,1@##..#?????#???? 2,1,1,4,1@?????...??? 1,1,2@??.#?.????#?? 1,6@??????#?#??????? 1,10,2@??#???????.??.?.???# 4,1,1,1,1,3@.#????.??#????. 2,2,4,1@?????????#???. 6,1,4@.???????.??# 6,3@?.??#???.??##? 6,3@.????.??#?? 2,3@????###????????#?##? 1,17@??.#.?####?.#? 1,1,4,1@??#??#?#???.?#.? 6,2@???#????##??#?.?.? 9,2@?.???.??.????#??? 2,7@?#??#???#???#? 8,1@#??????##??? 3,1,2,1@#..???????.#?#?? 1,4,1,3@?????##?????????.# 8,2,1@..??????.?#????##. 3,8@??..????#?#?###??.?? 1,12,1@.??.???#?. 1,5@??#?????????.? 7,1@??.##?#???. 1,7@#?????#???????# 1,1,1,1,4@.???????#? 1,3@????#??.?#.????? 6,1,1,1,1@#..??#??#???.??#? 1,7,3@???.??????????? 1,1,8,1@?.???.##??..??##??? 1,4,5@...?.?????.??.??##. 1,4@????.??????? 1,1,1,1@.??#?..#?.?.#???. 1,2,2,2,1@?#???????????.#?#? 1,1,1,3,3@????.#?.?????#.. 1,1,1,1,2@?????????????##? 1,4,1,1,2@.???.??##???#???? 1,5,3,1@?##???????..?.?? 4,1,1,1,2@.#???.????#???#? 1,1,1,3,1@??.???#???##???#. 2,13@???????##???# 4,4,1@????????#.???#??.. 1,1,3,6@.??##?##?????????. 12,1@??###?.#????.? 4,5@###?...#??#? 4,4@.?#??#.????#.???? 5,2,1,3@??##.??#?#?.???.??. 3,1,1,1,1,2@?##?.?###??#??????. 3,9,1@##???#.?#????#?? 3,1,1,5@??????????#?????# 2,4,6,1@?????#??##?#..#??.? 10,2@?#????#?..???.#? 3,3,2,1@?##????#???? 2,2,1@#?#???????#?#??#? 3,2,8@??..?#???? 2,1,2@????.##?##.?.??..?# 2,2,2,1,1,1@.#?????#?. 1,2,1@??#??#....?# 5,1@????.?#??#?????.#.? 1,1,5,3,1@?????.?.??.???. 1,2,1,1,2@???.??#????#.?#. 2,7,1@?#.#?.?#?.???? 2,1,3,2@??#.#???????#?#??.#? 1,1,2,2,2,2@##???##????## 3,3,1,2@??????????.#??? 1,2,1,3@??.???#???.?? 2,1,3,2@????##?????##??#??# 6,6,1,2@#???????.??????? 3,2,4@..#?.?#?#.???????? 2,2,1,5,1@???#?#.??????#. 1,3,2,1@??.????????? 1,2,1,1@#?.#???.#? 2,1,2@?.???.?#?? 2,1@????.???#?#.?# 3,6,1@?.??#?.????.##???? 4,3,2@???#??#??.#???##?.? 3,3,7,1@?????#????# 1,5,1@#??#?????##?? 1,1,7@.???#?.?#??? 4,2@#?#?##???#?#??#.?? 1,1,3,5,1,1@?.???.???.?#?.???.? 1,1,1,3,2,1@????#.?????.??##? 1,1,4@?.?????.????# 1,4,3,1@#???.?.?## 4,3@??#?.?#???.. 3,3@??..?#?##???. 4,1@.??...???. 2,1@??????.??..?? 4,1@?????.?#?? 1,1,3@?????#?.?.??.??? 1,5,1,1,1@????????#???????? 1,6,1,2@???????.?#.? 1,1,1,2@????????#? 2,5@??????????.??? 1,1,1,3@?.????????#?? 1,6@.?.??????.???? 4,1@?.???.???#.???? 2,3,1,1@????.?#?#???#?#?.? 1,8@.????##??? 1,4@#???#.??????? 2,1,5,1@????????????# 1,1,1,1@??????#??????# 1,1,4,1@.?#?.?#??#?????? 1,9@????#??.??#. 1,2,3@?.?#??.??????#.?#?. 1,4,1,5,2@???.##?#?#?#??#??#? 1,12,1@?##???????????? 2,1,7@..?##?.#??????.? 4,1,1,1@.?..?##???. 1,4@?????####?##?????. 11,1@#?#?.???.?? 4,1,1@#??.#?#???. 3,5@?????..??????.????? 4,4,1@#??.?#??#?##??# 2,1,8@?..????###.?? 1,1,3,1@?.?##?#?#??.#?? 1,7,1,1@????..???#????????? 3,11@#??#?????#??##?## 1,3,10@??##?#?.?# 6,1@?????###.??.. 1,3,2@#??.?.#?.?.? 3,1,1@###?#?.????.????#?#. 5,2,1,1,1,1@??????#??# 4,1,2@?###.?????#?#??? 3,5@???#???????#? 7,2@?????.??#?.?? 2,2,1,1@#..#.?.?????#?.? 1,1,6@??????.??#??#?? 1,8@???#???#???#?? 1,1,3,2@#???..#?.???? 1,1,1,4@.???.?.?????#? 3,1,4@.??#.?###?#? 1,1,6@?#???.?#?#?##.# 1,1,6,1@?#?????#???..#.?? 8,2,1@##??.?.???#?? 2,1,2@?????#????#?.???? 2,2,3,1,1@??..?#??.?#?? 2,2,1,1@??.????..?##??#??? 1,2,4,2,1@.???.?#????.?? 1,6@?.##?????#..????. 8,1,1@??.#?..???#. 2,2,2,1@???#?#??????..??? 1,7,1,1@????.??#.????#?? 1,1,3,1,3@????????..?.???##? 1,2,2,1,5@..?#??##??.?? 6,2@???.?###??# 2,6@????????##??###???? 13,1@??.?.#?#???##?? 1,1,1,7@.###.?#?#???.? 3,5@?###??..??#?##? 5,6@...?????.?#.? 2,2@#.?#?..##.?????? 1,1,2,1,2@????#????????#?? 5,3@#.??##?#??#?.? 1,8@.??#?#??..?#??#?.?? 5,2,2,1@.##.??????##?. 2,7@???##??????.#.?? 6,2,1,1@.??#??#????.??? 6,1@???..???###?????? 1,1,1,6,1@??????????? 2,2,4@?.?.#?#.?????? 1,3,2,2@????.?.?##?.? 3,4@..####??#?#??#?.?.#. 4,4,2,1,1@.??#??..?#??#. 2,5@..?.???#..?#.???.#? 1,2,2,1@?#????#???????? 8,2@?#???....?#???#?? 2,1,2,3,1@???.##????#????? 1,11@.?????#.??#?##???? 4,1,2,6@?.#???#??? 2,1,1@##?????#??? 2,2,2@???#????#??????#? 5,1,2,1@????.#?????#?#????#? 1,1,4,1,2,4@?.??????##?#???.???? 1,2,8,3@???#??.?.?? 2,1@.??.?#???##?????#?. 6,3@.???#??.?.? 4,1@.#?#???.?. 5,1@?.????.???#???? 1,1,1,3,1@???.???#?###?##?##? 1,1,11@??.??.??.?? 1,1@.????#?#?? 1,4@.?.??????#????.?? 1,6@..???.?.?#.???? 2,1,1,1,1@.?##????#?#???#? 4,1,1,2,3@.?##?#?????#?#?? 6,3@????#?.???.? 1,2@????#.#.???##??#?? 3,1,6"

let data = rawEx
data = data.split("@")
for(let i = 0; i<data.length; i++){
    data[i]=data[i].split(" ")
    data[i][0]=data[i][0].split("")
    data[i][1]=data[i][1].split(",")
    for(let j=0; j<data[i][1].length;j++){
        data[i][1][j]=Number(data[i][1][j])
    }
}

// console.log(data[0])
// console.log(data[2][0])
// console.log(data[2][1])
let totalPos = 0
for(let i=0; i<data.length; i++){
    totalPos += countPossible(data[i])
}
console.log("-----TOTAL: " + totalPos)




//data is organized as an array of input lines data[x], each line seperated into 2 parts: data[x][0] is the array of starting symbols, and data[x][1] is the array of numbers




//takes in a board of # . ?  and returns the count of #'s and count of ?s [#,?]
function countChar(board){
    let hash = 0
    let quest = 0
for(let i = 0; i<board.length;i++){
    if(board[i]=="#"){
        hash++
    }else if(board[i]=="?"){
        quest ++
    }
}
return [hash,quest]
}

//1st: takes board of "#" and "." as an array
//2nd: rules of consecutive #s as integers
//returns true or false if valid board.
function checkValid(board,rules){

    board.push(".")
    let streak = false //checks if previous character was a "#"
    let currLen = 0; //length of current streak
    let streakArr = []
    for(let i=0; i<board.length;i++){
        
        if(streak){ //previous was #
            if(board[i]=="#"){
                streak = true
                currLen ++
            }else{
                streakArr.push(currLen)
                streak = false
                currLen = 0
            }
        }else{ // previous was not #
            if(board[i]=="#"){
                streak = true
                currLen ++
            }else{
                streak = false
                currLen = 0
            }
        }
    }
    //console.log(rules)
    //console.log(streakArr)
    if(rules.length != streakArr.length){
        return false
    }
    for(let i = 0; i<rules.length; i++){
        if(rules[i]!=streakArr[i]){
            return false
        }
    }
    return true
}
// test for checkValid
// let test = [".","#",".","#","#","#", ".", ".","#","#"]
// let test2 = ["#","#",".","#","#","#","#" ,".", ".","#","#","."]
// console.log(checkValid(test,[1,3,2,5]))

//help from chatGPT
//function takes in two numbers, the number of digits for a binary number "n",  and the number of 1's in the number "k"
//it returns a list of all possible binary numbers with those conditions.
function generateBinaryNumbers(n, k) {
    let result = [];
    
    for (let i = 0; i < Math.pow(2, n); i++) {
        let binary = i.toString(2).padStart(n, '0');
        let onesCount = binary.split('').filter(bit => bit === '1').length;
        if (onesCount === k) {
            result.push(binary);
        }
    }

    return result;
}





//Takes in a single dataItem [board,rules] and returns the number of possible arrangments
//
function countPossible(dataItem){
    let countHQ = countChar(dataItem[0])
    let questCount = countHQ[1]
    let bombSum = dataItem[1].reduce((a,b) => a+b ); // sums the array using reduce
    let bombRemain = bombSum - countHQ[0]
    //console.log(dataItem[0])
    //console.log(dataItem[1])
    //console.log("?=" + questCount + "  #=" + countHQ[0]+ " totalBombs="+ bombSum)
    //console.log("bombs remaining= "+ bombRemain)
    let binArr = generateBinaryNumbers(countHQ[1],bombRemain)
    //console.log(binArr)
    let possibleCount = 0
    
    for(let x=0; x<binArr.length;x++){
    let testBoard = []
    binDigCount = 0
    for(let i=0;i<dataItem[0].length;i++){
        if(dataItem[0][i]=="?"){
            if(binArr[x][binDigCount]=="1"){
                testBoard.push("#")
            }else{
                testBoard.push(".")
            }
            binDigCount++
        }else{
            testBoard.push(dataItem[0][i])
        }
    }
    //console.log(testBoard)
    //console.log(checkValid(testBoard,dataItem[1]))
    if(checkValid(testBoard,dataItem[1])){
        possibleCount ++
    }
    
    }
    console.log("Possible count= " +possibleCount)
    return possibleCount
}

